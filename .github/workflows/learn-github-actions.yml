name: learn-github-actions
run-name: ${{ github.actor }} is learning GitHub Actions
on: [push]
jobs:
  read-all-feature-files:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: set JSON
        run: echo "matrix={\"files\":{$(for i in $(find ./features -type f -name "*.feature");do echo -n " \"$i\","; done;)}}" >> $GITHUB_ENV
      - name: Test
        run: echo $matrix
      
  execute-test-specification:
    needs: read-all-feature-files
    runs-on: ubuntu-latest
    strategy:
      matrix: ${{ fromJSON(needs.read-all-feature-files.env.matrix) }}
    steps:
      - run: echo $${{ matrix.features }}